use super::*;

#[derive(Debug)]
struct Testcase {
    state: MD5State,
    slice: &'static [u8],
}

impl Testcase {
    const fn new(
        a: u32,
        b: u32,
        c: u32,
        d: u32,
        msg: &'static core::ffi::CStr,
    ) -> Self {
        let state = MD5State::new(a, b, c, d);
        Self {
            state,
            slice: msg.to_bytes(),
        }
    }
}

const TESTCASES: [Testcase; 136] = [
    Testcase::new(0xD98C_1DD4, 0x04B2_008F, 0x9809_80E9, 0x7E42_F8EC, c""),
    Testcase::new(0xB975_C10C, 0xA8B6_F1C0, 0xE299_C331, 0x6126_7769, c"a"),
    Testcase::new(0x9850_0190, 0xB04F_D23C, 0x7D3F_96D6, 0x727F_E128, c"abc"),
    Testcase::new(0x7D69_6BF9, 0x8D93_B77C, 0x312F_5A52, 0xD061_F1AA, c"message digest"),
    Testcase::new(0xD7D3_FCC3, 0x00E4_9261, 0x6C49_FB7D, 0x3BE1_67CA,
             c"abcdefghijklmnopqrstuvwxyz"),
    Testcase::new(0x98AB_74D1, 0xF5D9_77D2, 0x2C1C_61A5, 0x9F9D_419F,
             c"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),
    Testcase::new(0xA2F4_ED57, 0x55C9_E32B, 0x2EDA_49AC, 0x7AB6_0721,
             c"12345678901234567890123456789012345678901234567890123456789012345678901234567890"),
    Testcase::new(0xD98C_1DD4, 0x04B2_008F, 0x9809_80E9, 0x7E42_F8EC, c""),
    Testcase::new(0xD4D3_E1E1, 0x7E12_7305, 0x0C48_E09E, 0xD683_12AF, c"R"),
    Testcase::new(0xF7E9_FE75, 0xFE65_DE95, 0x95A4_8741, 0x4A59_5107, c"bF"),
    Testcase::new(0xD3B8_EFDE, 0xEBD5_F531, 0xC2D0_C6ED, 0x09DD_F0BD, c"ktU"),
    Testcase::new(0xDA3B_F4F7, 0xEB74_322C, 0x02EB_AF51, 0x9B68_AC18, c"G4sK"),
    Testcase::new(0xF220_A8F7, 0x00AC_8633, 0x5A90_DA7F, 0x2066_06FF, c"GzgRg"),
    Testcase::new(0x7A4E_F06A, 0x84C2_85C7, 0x4383_2E73, 0xA8C8_4581, c"mKMhh6"),
    Testcase::new(0xF776_2493, 0x9AE6_C1CE, 0x09E0_1F5A, 0x9CB7_77F7, c"09hHanV"),
    Testcase::new(0xE4C7_E1E5, 0xEB97_8CBD, 0xB773_F1C6, 0x3496_C42E, c"wdKoKG7I"),
    Testcase::new(0xFB80_2A54, 0xCACF_AAA2, 0x491F_F9B7, 0xACF4_5BD0, c"oFoWcnsWD"),
    Testcase::new(0xC00B_D82E, 0x984B_F1D4, 0x1102_6E97, 0x05AC_18A6, c"HZ10Bk8H5K"),
    Testcase::new(0xAD9E_F3A6, 0x5AD4_2D41, 0xF3CF_3CAB, 0x9047_DD41, c"VL3aZfIOcpk"),
    Testcase::new(0xD293_5D44, 0x4F43_3935, 0xB1AC_F14E, 0x9C62_7042, c"smPeJPYeSmha"),
    Testcase::new(0xF8C1_AA11, 0x46FD_CE29, 0x6B80_F6F7, 0x977B_1692, c"tv00GjvVbY2Og"),
    Testcase::new(0xA9A8_0D87, 0x938A_D6B5, 0x4579_6A35, 0x9F53_3A6E, c"Q8U2K4BCnCV11a"),
    Testcase::new(0xBFA8_E8CF, 0x8113_E1A6, 0x5FF6_886A, 0xCF36_4304, c"6aie78iUwSnk73P"),
    Testcase::new(0x07A0_DCC7, 0x6803_F0D2, 0x6F10_1FCD, 0xD1AA_DC57,
             c"XuIrsMeJvzsCO7zB"),
    Testcase::new(0x57E7_71F0, 0xCCF3_BFA9, 0x348C_A8DA, 0xD701_ED1C,
             c"7i7E7MfpNBVrlSIfF"),
    Testcase::new(0x8FDB_84A2, 0xAE2F_1808, 0x411C_C797, 0x2B04_779F,
             c"c34xKvGQIIWCZNhAj8"),
    Testcase::new(0xEE3F_232D, 0x22EA_3BBE, 0xE106_DC07, 0x47C4_1C8F,
             c"tF6FU0hqDcQ2YKyhYrG"),
    Testcase::new(0x8F83_091A, 0xF9E3_E1E7, 0xF519_0C94, 0xC120_7239,
             c"8WeBcM6HvwNNiNuBG1pZ"),
    Testcase::new(0x256C_3C27, 0x8EA4_A4D3, 0xC7D1_8A81, 0xF5DE_D58C,
             c"HgYf7DBEBefrsRcIed5hP"),
    Testcase::new(0xEC40_5417, 0x4A3E_02A1, 0x0152_3576, 0xFFF7_BB5A,
             c"PDvff6QNerDHxjAn3W7I76"),
    Testcase::new(0x16D5_8F31, 0xA563_93EE, 0x14D8_6BD3, 0xC22E_AD07,
             c"SGJQvtWfqPhpZQjehTHTH91"),
    Testcase::new(0xEFED_9C77, 0xA94F_5B69, 0x391F_F963, 0xD20B_A203,
             c"H3yAcpmZrAQcbzbt6EyoI3aX"),
    Testcase::new(0x221B_0B77, 0xD1DD_32BD, 0x2CE8_C75C, 0x5AA8_F276,
             c"OaQJ9pLKK1LR7UJlslMSpCclP"),
    Testcase::new(0x69EE_970C, 0xE5A3_AFDE, 0xDED4_AB82, 0xD37E_C9F4,
             c"gG7Ug4ukuKUeAIrL4TXwuSLrit"),
    Testcase::new(0x63ED_AA8D, 0x50F9_DE56, 0x4073_3E0E, 0x8954_F890,
             c"k3ejOY5hbDaptsZ29HM2wNe1Ax0"),
    Testcase::new(0x66ED_7D7D, 0x5B05_CD3F, 0x5325_ECEA, 0x3D8D_4A81,
             c"fW1Xk48tbXTelPbhfqcVhZRQ8Tyf"),
    Testcase::new(0x0EB3_C186, 0x7E41_7CF3, 0x3C16_9DC0, 0x0E65_0915,
             c"WmZzClNzZRfLWlEjyjJPgJ6QAMmBN"),
    Testcase::new(0x32E1_5253, 0x915D_0B52, 0x609D_A449, 0xFD26_B521,
             c"QqzlDhECVECa00qJ6cYy7ce1NARfw2"),
    Testcase::new(0x4DDC_9302, 0xF831_D885, 0x9DC5_E249, 0xF988_B99B,
             c"y6Gfm3gpZIAvbLUbBi9Z5cBbe9NZSRI"),
    Testcase::new(0xD05B_2026, 0xF586_67B3, 0x9098_6570, 0xE06A_1235,
             c"WkIMzKROmGtzZTdAxVuKbPuEhH9H9Tr3"),
    Testcase::new(0xC2D5_EE46, 0xBA74_921F, 0xE680_7A7D, 0xE8C5_7F7C,
             c"XUmfmOc1pA0wxzdQxPZaxz1adAYcP4xVy"),
    Testcase::new(0xD693_E9E0, 0x3AB2_CB26, 0x9C49_96E0, 0x7A00_5297,
             c"bpXjD19JKq4hR7uLr5x6qtbaOdKVAV3q8S"),
    Testcase::new(0x0446_A62E, 0xB1FF_2DF6, 0xF0C1_DBC7, 0x7F6F_C01B,
             c"EuSMQEuXbesPle6PWswanFCkeuoNEbnkgMA"),
    Testcase::new(0x5232_4660, 0x455C_F558, 0x2F32_1C88, 0x5B95_B7BB,
             c"ua2h4CTDNpcEHtMKawWzQ5SmKFcYv6IHU96P"),
    Testcase::new(0xBDDE_2BB7, 0x6EB7_4CB6, 0x131F_A88D, 0xEA91_441A,
             c"bzxbD5NlFSf2204aJiy33JAeVu4zgS6ppBhoz"),
    Testcase::new(0xAAB9_3F93, 0x9B79_35C7, 0x0223_0743, 0x2F4E_D13F,
             c"RCYdfuBLeEMDnpJ9NH33a1m9bglIuInD34bLUv"),
    Testcase::new(0x9BC5_DBF1, 0xEAFE_E5D4, 0x6F22_6D42, 0x1526_6383,
             c"iEQiPIf5jaNiwl7bWsChqodEZXC5iCeFXHLpOZN"),
    Testcase::new(0x4B9D_810A, 0x4864_FF96, 0x591C_7E8D, 0xAB4D_9D2D,
             c"ZLabuZwlTSmK4wtaZX4vJMQn9VynV8xAu30QWn47"),
    Testcase::new(0xF9AE_9573, 0x86FA_0C27, 0x85F0_09BE, 0x50C1_920C,
             c"NNLGzwv3EduC2e0cS8xjl4O8NlpTbSTtzzVvPqhMK"),
    Testcase::new(0x2199_06C0, 0x4E55_4E85, 0x0D50_8CA6, 0x59BA_D101,
             c"QXYtQ9Q8ctGkzCiVQqV6utNtu71eP9Cfj8PhbC8Qai"),
    Testcase::new(0x2BD0_B6DF, 0xAA76_7F1A, 0xB5D4_F541, 0xB602_D797,
             c"bfAFrcQqX4WXGhbig45yIJHLvXHrbTFVkVOuaDBq5q9"),
    Testcase::new(0x4C12_AE5A, 0xB7EB_74C6, 0xED10_F197, 0x7D8E_427C,
             c"syQGG0Pp3dszmeEIP0CfLMoiVyUZ0ke0vAhVwKCHbrJH"),
    Testcase::new(0x8176_D8B8, 0xC8AD_B5F1, 0x3B11_D959, 0x4994_FE13,
             c"SiTqcJnZFr2reFXXxuypBmXPI0CSMKLchcFkSvM166E4l"),
    Testcase::new(0x1874_AFE9, 0xDF6B_8E6F, 0x7406_4507, 0x6BDB_1732,
             c"NY8YtaQvFjsCsezTkMVZOdZP7hSk3rRNFWw29yAKSD1WWk"),
    Testcase::new(0xCD4C_A77F, 0xA19F_A88F, 0x141A_FF83, 0x4C5B_2FA3,
             c"KxPsX271bXpbgkPh4pPIQ3VvBjwNYaTUDlameHHsjmrKIDb"),
    Testcase::new(0x5D77_A74C, 0x00CE_C5C0, 0x5151_2274, 0xBC24_F5A4,
             c"DP60v2RZUJAvlftKMC8xq9keGkJAzBJaqyLJWQObpo2QGG2J"),
    Testcase::new(0x8693_721C, 0x40EA_E64E, 0x8F2C_BE7D, 0xD8BA_83E1,
             c"IFvjiRKQXaUaAqh5RGDtCU14hr2Lu6m2H87WhxGEqvlSFNIK0"),
    Testcase::new(0xB508_BBD0, 0x0513_E12A, 0xA2EC_7E89, 0x00F9_F917,
             c"OOHZTgWzjsVJeqEKIfGnnaCOqgaung6seo1rdTAPm0TQ0Q2HX0"),
    Testcase::new(0x8CC3_7C94, 0xBBC8_35D9, 0x78C8_C055, 0x79F4_7254,
             c"zHUu6VkflLwQF1ov4cMwaDOdcsQDOiMaKfRPBqmCCMkSXuhwkQV"),
    Testcase::new(0x16B7_B4C0, 0xD9FC_2715, 0xC25E_DDF6, 0x589C_8A7C,
             c"eagIxzzi1piiGCIt04uYaov5t1UtXMf3tvxEgrGF60h08g05S1ag"),
    Testcase::new(0xDCB6_C216, 0x93C3_FCB9, 0xE271_A2B2, 0xD36E_BF69,
             c"UldA1RYiT2CZcxSVjFNUfbTFdi9gtdPux8QxNnzuGttz1thb9DJ4t"),
    Testcase::new(0xBA81_07E5, 0x2FE4_503A, 0x816F_0C5B, 0x9C3C_D3BB,
             c"dyiSPmf1uKe9MvOwRfpoNKHuInBcjmYcNx9zFrqaEikQa8rXx5uY6T"),
    Testcase::new(0x7E80_7E83, 0x55C9_682C, 0xEDDD_C634, 0x9E22_A816,
             c"tM3H5bdoBxjq6bN7G1Yv8qlVCZY5gurstfjcUEu9Z6aiD3Mz7aBa9Pm"),
    Testcase::new(0x6400_8BFF, 0x9D25_1584, 0x2481_666B, 0xEB10_5BED,
             c"JYkP3Tng92YbCLTX8yCxKVuHqUV4IAh5jfPqKlUXLJVuc6F8FqxUH2pj"),
    Testcase::new(0x8F31_C9BD, 0x8928_5E1F, 0x0C0D_C570, 0x0CFE_8DB3,
             c"lrcQ3a7c1J8nHfirGEQaStpVAWUwSVvCJUONn7pA7mCaIkrh6qw4TQXyA"),
    Testcase::new(0xAFD3_50A9, 0x7E2B_EE06, 0x1515_D360, 0xDC3D_7947,
             c"g3CPerz1XRuyqgARRo18G5MJi6oYotzmSQJdNkixO0534pyMAMGvcbnlJw"),
    Testcase::new(0xC125_A2EF, 0x61BF_2AF1, 0x18D5_A548, 0x937D_271B,
             c"sxXQUcEGd4Ut4NDfRwu4RTN9Ct6NDXfeNi8kHCzQrmV5Vhllbo1jjUC3KVP"),
    Testcase::new(0x6871_4CE0, 0xD857_EAE8, 0xD1C5_2E96, 0x6C4A_9E81,
             c"RLD5vWm8bZZef0sD9rLshDXzjUpiylwjaKzObe2tIOLgwxcjdA348x3Lq3gB"),
    Testcase::new(0x6A00_77D5, 0x3A22_0075, 0xE3E0_F501, 0x81B3_A16E,
             c"9mnykrPN9l161zuEBk02Db4Fu008g2lmDguhsQdB7GJgV0yuszXuL8TcUdheJ"),
    Testcase::new(0xA8E0_D206, 0xBFAB_7ECD, 0x14C0_7C77, 0x3BFC_4091,
             c"EePNTxKilALgnV1jaoxbQtLTQ8yqYq4q7jLi1auDDkVIBSrtTzyYN7HJAh81sO"),
    Testcase::new(0x7890_1555, 0x36C7_80E7, 0xF00F_C35E, 0xCADB_81BF,
             c"xPFRANqGeIWcKdbFk98b06W3QDEUHeFqjdFrwc6KqEfGVuEim6UIbES87Mb1Eus"),
    Testcase::new(
        0x43E6_5A3B, 0xC694_01A8, 0x15EF_B9E4, 0x931E_5B36,
        c"zUdm1DGV8cp7E1sr2HUzOFKao16iTxb3DPho8oTHBCug7QDKWN3uUlIRBDzzDRKD"),
    Testcase::new(
        0x5251_0C2B, 0x06EA_5D9F, 0xB207_2F34, 0x5683_5D4E,
        c"kEUNEh88JySVSgm48ID1XnRVLu6d4K4b3fuF7NhjrsTDruFN5Zx04sOr73LHbhvLg"),
    Testcase::new(
        0x21DF_417E, 0x8BA5_DD3F, 0x8F2D_CCF6, 0x4CBB_308C,
        c"OHjPaKHrT4Jmsmwrg5Z7fjvzcFhmXyOyIE1ELUfhXFgiznD73NZRDBC5f4cii4r0mO"),
    Testcase::new(
        0xFCF7_467C, 0x3AFB_8C56, 0xF563_8529, 0x4545_56EC,
        c"GlZvk1oCc1x5olxQcqNyMxfWuxbL7aKTCBCjtuUPSrtagKQzh7C7varmQZLKandkS6r"),
    Testcase::new(
        0xEA80_A772, 0x1F4A_EA7B, 0x6C47_F538, 0x8E96_C5DA,
        c"4KoQZfwddrkj3LuPsOj6Nc6WsRABNZdx0kTb6uI8Ef4b3irKzA3IBRuiGSdsm3dRPj97"),
    Testcase::new(0x3266_F48C, 0x27A1_853D, 0x8524_9A20, 0x0F47_1863,
             c"unPVi834yoLbowrudh0XZlOidLAP6ZXR0h5Ck3d3K8qsdubziUJo9zZLO4bykyW6TBzNI"),
    Testcase::new(0x2E7C_BD90, 0x340E_7CA4, 0x3F67_50A2, 0x2EA9_5E67,
             c"aL0dcyd0I5GWHItgOihrBSBMQWwgT8KT65YqeweIUnAeRvYeGDLlsOeplAYIraEKUNFm6k"),
    Testcase::new(0x41DF_3045, 0x6D59_2260, 0x9171_7E45, 0x1921_EBAB,
             c"zB65YAy5ERxmYaqzm9u9mDJbrtZ9n9IVgRdZsHUT2c9hXPA6KSiOZEq527Ib3ABK7ncccel"),
    Testcase::new(0xFB31_A55E, 0xC3A9_2DD7, 0x9311_318C, 0x0558_9E7F,
             c"XNG1jZVVraAlyhh4IoTuOyF6fHGlYvmkLuAa9H8x7hukzYu0Oh7Jv9MiKzSlmXWHA5W7Ka1G"),
    Testcase::new(0xE8C4_A831, 0x2CD1_DD0F, 0x63C2_54AA, 0x699B_42EA,
             c"dJHks7hUjWFEg8akDppoXwbhBb1JkDDP8PK75kQkq47K0mOvUCz8e0GHxWsGTSNxt22CgZYOw"),
    Testcase::new(0x7546_B2CC, 0x824B_CD81, 0x1D51_665A, 0x3825_14FC,
             c"pp2Y85Fo02fgDEIjsFSbZGMnc702uCcyNxcremHaNDIgVYGYZP60E1T0DrYuMrbMM9LInMnbRv"),
    Testcase::new(0x553D_F40F, 0x7E41_B398, 0x718F_E463, 0xE2D3_98BC,
             c"tuzYkOa7dz4IWFtFqQcKsNKD6oHqxdRtX6puCxR1uwcVevP6nr6l9xcXLbSPSnP00ZN21Yerq1J"),
    Testcase::new(0x4FF3_FF92, 0x5625_E15A, 0xA384_D63F, 0x828C_730E,
             c"OTbnS8fo6i4oDt7raIigeP5MBwUYDeyh2Rz9OOWkH64EXRpvwl0Z0AInubtMWnNctd5zQPhEohBD"),
    Testcase::new(0xF065_F35D, 0x818C_3616, 0x5921_FD19, 0x3E66_3898,
             c"oyegc0dV1RKUU9w6PpXFnkX6J6byJSS0O0BuQ8MWdqZQ6lIcJpU7magAiE17QkvZUnvJWEoY3GC5z"),
    Testcase::new(0x9028_DBAE, 0x9A3C_763E, 0xE1B1_A96D, 0xEA34_2827,
             c"M5ScDjt8Gv0F8eQvRZU8prp53CaI9aLXCT5v2Q6CSd2sMbVkfExByZDozg6BmNZKVKtoqfPbdGpPu1"),
    Testcase::new(0x30D8_B814, 0xF12B_78C4, 0x527E_1015, 0x8C5F_0FE5,
             c"u1ScuAVgLqxHyV7k2icxLgEGst0HkHa5l7PFi6OazdPn2DUMegC7mx1GUSdZ91k99M29u1kLGDElT66"),
    Testcase::new(0x3111_C056, 0x53CB_BC38, 0x1B2D_D88C, 0x39CB_497A,
             c"0DrAwYvwNTG4j5LCrtS5aPG9OIz49GGgkeb5796m2tNTyxuDQekLDIlyGCEzI4XIcmtRPIXTirdIk7XJ"),
    Testcase::new(0xACDC_E674, 0x4C8C_4C3B, 0x405E_8723, 0x8B2D_5B5E,
             c"ef9ToIGJHX556iQqXtfFELTU9Rm3TiBP3aOUhTpNUa7nqAZ8oJ95gU9NTuODDy1SK4txXuIjHxprEZJEB"),
    Testcase::new(0xCB6A_B927, 0x436C_6592, 0xE21B_F191, 0xF3AA_9DC5,
             c"Qr78u7s2TWEVK8hKbf4JxasPMbTdu19tii8hejzGw3JdpjpTVJ8OHIvKxRhEMMzL0Uj9DovLCJpEujNfeV"),
    Testcase::new(0x9E62_FED9, 0x072D_0DB4, 0xE07F_5A34, 0x5F3A_5924,
             c"cPor11tvb7JwrEJ0eQeU0UBMaWdB1LRZP80Qowq39XyoKgsMOHGfhheGnznYRDkUR2HDOHFywJYrBTsn7Xb"),
    Testcase::new(0x0951_7726, 0xCEF5_7592, 0xA390_727F, 0xF8FA_1CB1,
             c"olSeNrAmXDa9xsrcCmZcEaDaQ81VeJnzSiVQSpYYk7DpP1XcHJX74G9Jz7RPunxVB6um5LdOnXtyIGX2Z0o2"),
    Testcase::new(0xAB44_5B8D, 0xF0D9_1E4C, 0x2779_3E99, 0x3A30_4D75,
             c"R8IcKd8Gf4rCqOZ4LJZvl5OjO20wGX7AGMYkQNG5Rma3phEjuCujSbuOsTZDeJsmuMd6WEqqDdsLbOs3ogrxM"),
    Testcase::new(0x1D08_C15C, 0x57AD_F5E0, 0xE252_0AF4, 0xF051_427F,
             c"Dm5AKYAYLpPcN056HgldMywoSeZZp8lYQnQ6JIn5oSCZuk32TtaPZc2mWgID7k34b1zKxpK42lSJk888XT7JhF"),
    Testcase::new(0x6261_CB3F, 0x05F6_B903, 0x6E69_93D4, 0x509E_73EF,
             c"NffucZeh6W14sXDUKydGQE7z4RRxN1PY7Mid8sVTtrRjvqAr9grz3IE5zRq0OCmWn19JOEWi7drQOOLJoxpGnX4"),
    Testcase::new(0xCD6D_68B6, 0x7E4C_33CE, 0xA717_F0FF, 0xAFB0_5E9D,
             c"IWQeOuaNssgljfb5DtDAxZV1jRYPVwSYZAKXMDs2jaVF9xuP8pxF5neZUJRyI3uVWK8G9nWAaY64Du2K0mO2g8cO"),
    Testcase::new(0xB23C_49C0, 0xF98F_C3C0, 0xF074_8BED, 0x91D3_644D,
             c"k1qlRHwawVcff3cgGGHu4AkWGYOkmBZxkVUZEFo8S9BJEuEonSOOTrfx34n6UCAxG5cWP3njT49ba4kyjdX4FR58g"),
    Testcase::new(0x9B8D_8628, 0xC74A_559B, 0x9F4B_C0E9, 0xB96C_25F2,
             c"dqRql8HmoAuow4hoIiOEylwc8pakMAO0pghJR2d3thpsUkO9KETwORS8KQ2SBcdi94mE6khZo30kuoiDiYcTevwU7u"),
    Testcase::new(0x163A_D044, 0x7303_0F3D, 0xE045_EE23, 0xAE44_91AD,
             c"MmE8rLdBPAYlKx4dtTddDR4Yp8OBYUQAJlfeLtqKKpTyNXY5o4TtYIyhdGMu9poXBxIHaxVJ7Nxbs8LFC8qvf4O8TFx"),
    Testcase::new(0x2E30_E66A, 0xCF57_D099, 0x9F19_EBC8, 0xF2EF_1999,
             c"RW1ggoOeADsf5kW7u9ifGyBqKYe96QTvKMgN5oehLCR57beGr9qCDwMI8LzRxtjB3wcrOsrbP20lCjg97VEDbeTHyCsO"),
    Testcase::new(0xDEE7_C62E, 0x989A_DB3E, 0x16F2_624E, 0x9C9B_0B68,
             c"8kdPTIhD0XWeafN7BuuzRK0TtooVdz3gUBTA0iGMvQq1SnookonDrzBTyXovab7QVsMpV1Bx47NhxaGrgh9KwHNSAoUsG"),
    Testcase::new(0xAC1A_01AF, 0x122D_1A1B, 0x1A42_56EF, 0x3FAA_A185,
             c"pMS3Jr4qy0fui2pcQNHmkc5bS0TmF3qqEU1pyB7opVbiByDxiHYcishM3nU1LB6Adm84epTHVDGBT2XGPQ29es7j1Rv66a"),
    Testcase::new(0xC85E_A519, 0x4939_1103, 0x5FC6_8CEC, 0x489C_1FA6,
             c"d2IslAKdtlHJ6T8ba4pZ4WXvMhGEKkc3IhGobhIgnj1G6bad0cb4wdmMoVarJv3r7cY2dDiUPukunV5jhr6F1AKIZKmHauQ"),
    Testcase::new(0xE434_5B91, 0xD94D_3B24, 0xC6E6_D71C, 0xB09E_F1C9,
             c"lwzctPypbPFBsaPK5nKX8dy1OFLGgpTH75aIQtHpul9O2A7uerAWGHPi5pgwbE5upOeqKkHyRpeN4bTUavZoQhsLdljGVa6N"),
    Testcase::new(0x1E40_EF0B, 0xBF60_651E, 0x0F1D_B986, 0xBCD7_9EF1,
             c"OdkVU5ZZ1xDS9zyMhFTg8CCPasc6ZE9fUNjYli11SYI0gOPwJUQA6IOuRrXfVg3wwdOXpSAexfCsx54nySrdQh18voxRKdecH"),
    Testcase::new(0xA6AE_3EB1, 0x61DC_65CA, 0x289D_77E8, 0x0CC4_C33D,
             c"TAjlabpvpCE9dBU8ixmSoQtgP5odIXEcAE8DTZ5fNTVZUOexlHh1TZy35CoTEOX9iYohnfscDcoODoJta9wk6OCvoq1hbz5pGN"),
    Testcase::new(0x63A8_6A23, 0x42B1_65DB, 0xB9EF_CA94, 0x4973_DF7F,
             c"HoEjAbfScO7kbjvxTHKpmmzaRvqN7ynO147VNeWqf43Bit3ZVtRoLEoBMPC13iX5JP5kvvgy6KAmmkeKi4zdhMMOKjGn07sQsXP"),
    Testcase::new(0xBBAA_69DC, 0x02A6_A3F6, 0x5278_7548, 0xA029_1724,
             c"0iVg1bQQM8HqQNXGqWPF8FF04ykspd6UNUJknxCz4nIH9X7CQiXDea7FRJ0JUO5OZJKENLEL6xQ3ku5y8KBBTNIyExxRtfn3SWOU"),
    Testcase::new(0xF62F_853C, 0x965F_99A1, 0x9D39_54FA, 0x08EC_F4A7,
             c"47zklt1T72Re9rJ1WJFDWyup6XuXwNgk5Hbq6Nh56TgTzbVErbkaMJ5ekGPwWi7rKTx2mqlzKwmYwvIyp31IBQYOLMaOQnfhiGtjH"),
    Testcase::new(0xBC8A_8370, 0x5FC2_FC71, 0x3469_DF9A, 0x7CDD_5BBE,
             c"rp5Bu5726BIy6z0Y9E4CSyG8252bdsm8PkmRHIqI4P3IYJ3I4k0zqzGIcYsvYmjLqmev5ffuqKO408iuWauZLdzPwOoLL4Ao5FPbxq"),
    Testcase::new(0xD561_F576, 0x22E4_3A21, 0x23F0_36A4, 0x7B05_6B12,
             c"HxslyleFqKgThXoMoV7A1z6xqNK3VhXWI8fI9ESCejTtWn85HwFQBx1zIxRwEdvjxG4Nx64EWbYkTH0ltItyQnqpi5szfrHE0YEUhY7"),
    Testcase::new(0x38C3_848E, 0x0923_4B8E, 0x7344_6778, 0xDD33_5D60,
             c"rk4m1SfYrCcWoPSYrSnzTLuuIEmXSX0LcoSrZdoELRVffSBXAaJtUZyYYLcTiUfQP4WudruaTD4Q6r5plZHdpCvJS3gwqBR8H7J7VGCm"),
    Testcase::new(0xE723_7E08, 0x6F4F_7B17, 0xED5B_17B5, 0x0C7F_AEB7,
             c"g6AzU2WAktArsucbL6MWIU47tgsAhdxDoc3KmrscpW4byqeUYYGxXlCOvv2rEubDiDFHyHmXvQBFe1822HOMg4vVf9G9LmQui4IpriTMr"),
    Testcase::new(0x7296_1C58, 0x5C2B_C42B, 0x8C65_D6CE, 0xB0A0_C872,
             c"ivskCAVSoHz5RBFWun5jmVnrwxgRuS7ZxLKnhx9qF6c9Qu7Tz4rYe5NDCj45CyuyzVJQdCccN7wJ9knVhvnITJ5N9KxbEgnB2BBsUkJOYz"),
    Testcase::new(0xE769_C6F1, 0x6A2A_7780, 0x867C_37B7, 0xB5B5_6634,
             c"00Qr84agVMTMi4G1VRtQrunuAzGqY09D30J36ANKA0bxewAEKH9jCeMzEElhvrXICdwr86fhV3UwmOnhsPvWaFzmjz9Fb5lj0tImDlFO6ly"),
    Testcase::new(0x2255_01D1, 0x4D01_487F, 0x4D4E_0A9E, 0x50CC_7419,
             c"UnGiz3mseeYogPocAXdWGHdk12xA26jhSTFu4TA6Upao1bfqGD4nz7FnH5WQnIyedEHXTlDKNWirEPw1fARDhXSgQQtnD59CdDPCjUUomwel"),
    Testcase::new(0xEC36_A8DD, 0xFC75_F8E0, 0x7B6B_82D2, 0xD4D1_8A92,
             c"UKXKybnTExXhAVox22AAd03iuLepY5tLg1pBjPzmRj3SzuBjpU4l1epC2NGjHmbAPHYqKNEqoFKKVmYeNRpZ7R8A3SSc1G7p9iLgiQvhexCeD"),
    Testcase::new(0x9F1A_D7F3, 0xC52B_1DF3, 0x5CFB_093B, 0x2B22_7175,
             c"HYynEAw1WruJMcHcchwe6e0iz2wdWRFKROmfnkAAfCfiN0KIEMspwrS2cPTeOJiefvl4aX8qDegCurOWjXoWhXRLYdp8Btnrx8M4IId7uCyewx"),
    Testcase::new(0x6114_646D, 0x4D83_8664, 0x3D08_0CDB, 0xC966_0A9F,
             c"OwxG4rMTtqmA6QWwAn29V3MJqMYICqahNqkaSuyVUpMRFjjPeQ6NX9HVOS8EomWtDq3DmNrVnFAdLV1eu5JLGpJP3RJxieHlQ2SauadNhKGawna"),
    Testcase::new(0x5AB0_4CD3, 0x1C14_C840, 0xC8EF_162E, 0x8C23_B161,
             c"yrN96Qxdq3pgHmnDIhWNdykCnlx1biFWaPbyNbadeS7kQN05SLwM1PhdlGHrCzfDiKusCIdZaFJoo6vSHPMlUag8EOsAtGKAXySgaEIH2xgAuZ6N"),
    Testcase::new(0x6A11_3E7E, 0x5D57_B1A1, 0xAFDF_F1F8, 0x78EB_36E7,
             c"BNBn1gd9xsz8RcMeAXPstzQGcJv6DeJNYVdIXb1SyCm6i3qGeuwchr94k1KRERqIYi7ZvroGylntecFjunhwAUL6lZiXPKCDAMtB9wwnwQcUeennT"),
    Testcase::new(0xEBCE_9D9B, 0x4272_5BB5, 0xB483_5A6B, 0xCB35_8FD7,
             c"nqmrFzi1R1dVcVz7DiJkfwjVovDH0gmD7Eq2XDURshzw3Wdf53x7BnZAGzKmdqHUCntW5aiIUlSUkny6UamI4KY0pkx672kzzzhvpr7Ob2vDL4SriP"),
    Testcase::new(0xB501_5C40, 0xC65A_A411, 0xAA21_78E0, 0x6C05_6DE1,
             c"l2UdZG1zblzvXDRjyFuepYdHlvJC5sXAUQPuqQEKupoxRzpd3bjz2PqLw8TVlHEeSj7lOQGf3nSGE1KRKJcMc0AZwsmO6a8kdKyzaXIdGjWAMwk08tG"),
    Testcase::new(0x85BA_BA71, 0x3400_7647, 0x2BF1_307E, 0x3079_6A33,
             c"1hJkDIRoBuk9VMsfRzDTmYBHthT88RGb9j53kQx1N4zotBbtgq3aA5zRjH5aBwNyWj7hkLbINXvQ8a5A579ua6r00rgAItpClnUvBl5PWGjvEjk5fuPK"),
    Testcase::new(0xA8BE_39D7, 0x29E4_E51E, 0x0919_08EA, 0xDD7D_BC64,
             c"qnPiopeaePsrhcI2FiUuxUOlCGeHQ7NpdwTvdjDjpxAT9DgXwW7pKCS0ofuKU0utSARBLhAAt0gubjdMGf8Lb8wbByVuP4VpFYrxtPgZ0VWNLlSm8BVqe"),
    Testcase::new(0xDA6A_36DC, 0x8018_B902, 0xCCB4_ADF7, 0xA43F_8ECB,
             c"6NidrvZxiQInN99TkKUebIx6h8vegYJ6giUNWNbuaqF89FVG7PZocLuwqHM9ReGVN7nRReVSIAMcJC4oJ9BoRp9vL88MktqbTH7PEIKpww7E7FPoDgC2ms"),
    Testcase::new(0x6877_FA07, 0xD846_FCE3, 0x83FA_6ABA, 0x794D_D858,
             c"uWNMpBRcVzJAc3FcUYaN6tvpAiKeHkvBIhVj2pIXQbutaDf22MLWzj10HUWMshpnvRsyLGmCw5AAXeL9M4KIqf9W5AbWrVvVFdo7LCkIodUs3BDDImMTJ5Y"),
    Testcase::new(0xD672_08B4, 0xD3F2_3607, 0x7082_6F4E, 0xCB76_4F43,
             c"LMd4BAMxLfB359jiZ0U4ZTzT3HDlMGTgrO6LF7EcfARdeFPvVtb3XMmzL1DgqIzg2j4jLzoaHqCB4u7TYRBiLAAeZAul7Dylr6DxvuCmcowBR0UmxVhRfJoq"),
    Testcase::new(0x35DD_4354, 0xADBA_EFA1, 0xACCE_AA4F, 0x609C_B5A2,
             c"aXTmrkxaTvcttGu8UGpSDtZSzCwwlnDyym7bKRdUn8b4OG5Zj5hqqQ67w3UkEC7QPCG1PRTGeoS2WotGgiwYyIHWIVL8B5oQQMBXcU2pESnA5tbMA9iWhPtNR"),
    Testcase::new(0xA54C_BAFA, 0x1B15_74E6, 0x7849_BBE5, 0xEDBC_1098,
             c"SXtrNyT3xELAmZJtUx9tOM7Invu1dX6jMB5FnhYInvRh2jfB5wYcQh98SZNpFdcPBL1xXh1VnvUUncJmaflPo5YiiwHAVBFPkcCuNZfHUiElAh0YPEXkJgFHlK"),
    Testcase::new(0xA5DB_7048, 0x26D9_F12E, 0x8C3C_5658, 0x1843_6436,
             c"hTRhjMgK40USYKweqxwCOQCp7Evtcg716ZdWaQ8Gcg5hnPskRl2AAUxCRG1CXEbOHj6oho0KEsdpEhaAWN7Ga28Wuy2pBvyqbziZsPOFLGjXW2PcmaaerttOCXn"),
    Testcase::new(0x9D4C_5DD4, 0xDD04_E1F3, 0x86B0_AACC, 0x10F9_DB23,
             c"teWBrKl02Tf4c4miKdHnOgqMEVjQK03ySZbUq9RYbFzql0Bp2eKXL7hlNcxuqDoyX0N0GrIuhPVvZ2l1aeSJYlCGDTog7DKTjW770bUX3XWdG6asBkR1UTOt6T7z"),
    Testcase::new(0x0321_1FDA, 0xE3CE_C4C8, 0x4FCC_DD95, 0xE7F9_EE52,
             c"eaQqSibvOFff5NTaCZPG8aGSrZbJJOWgcqugpiNdZ7rXUIPZgHfhRCgRGwYmyeLjyuesyPiE2f8dqEsPPLNXfcM1mtNyr7KREuJVS5xFkcDjseIcNwlFs8dlrwd9i"),
    Testcase::new(0x9315_3A6E, 0xE863_B86B, 0xA767_A7EF, 0x8F91_DCBE,
             c"2mg5WYU6vOsRRePoarODDSEBJW41CDt9cN4NHoKDBFFp5YX6yVylFmqRCVqwEwQ2pHO5QlAPaguJnVJhf28RyfcJItvc6uf30zXa9q9ivkygHFRSqixcn2yiaCvqUc"),
    Testcase::new(0x1C52_2FC8, 0x2A9F_DFD1, 0x3228_ACFD, 0x1B69_2202,
             c"6ZlMjcSt4yedTYAGXrtSwKfbxfcUJKErBgrgzwOZHUESfTeXmxhFwsOoeNHPABbX3fVO38IXWNYmrLeJRDh7iMlHI4xxQeWeXrVWkjCy2aiFN9hLPyZRGMJ9r5upxjO"),
    Testcase::new(0xC807_7A52, 0x7BBF_C6DD, 0xE10F_D5B5, 0x5CA3_50C6,
             c"eojYUfdQ7vky8jpCUw1yBU1vHMnpZlnVpK01f1LPXVTgsBvqcNjYwdRxsBuSCnwnGCvQK1EjkHE8BTL93tpPvlJ6M1q8gUBgacf2AXNiWWu5UHGpxpyo2tZUrZwAtJrL"),
];

#[test]
fn full_test() {
    for testcase in TESTCASES {
        let mut hasher = MD5::default();
        hasher.extend(testcase.slice);
        assert_eq!(hasher.flush(), testcase.state);
    }
}

#[test]
fn in_parts_test() {
    let testcase = TESTCASES.iter().max_by_key(|c| c.slice.len()).unwrap();
    let rest = testcase.slice;
    for len0 in 0..rest.len() {
        let (part_0, rest) = rest.split_at(len0);
        let mut hasher = MD5::default();
        hasher.extend(part_0);
        hasher.extend(rest);
        assert_eq!(hasher.flush(), testcase.state);
    }
}

#[test]
fn to_string_test() {
    let mut hasher = MD5::default();
    hasher.extend(c"Hello, World!".to_bytes());
    let hash = hasher.flush();
    let str: String = hash.into();
    assert_eq!(str, "65a8e27d8879283831b664bd8b7f0ad4");
}
